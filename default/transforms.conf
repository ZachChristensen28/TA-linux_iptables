# DO NOT EDIT THIS FILE!
# Please make all changes to files in $SPLUNK_HOME/etc/apps/TA_linux_iptables/local.
# To make changes, copy the section/stanza you want to change from $SPLUNK_HOME/etc/apps/TA_linux_iptables/default
# into ../local and edit there.

#====================================
# Sourcetyper
#====================================
[iptables_sourcetyper]
DEST_KEY = MetaData:Sourcetype
REGEX    = IN=\S* OUT=
FORMAT   = sourcetype::linux:iptables

#====================================
# Field Extractions
#====================================
[iptables_extract_kv]
REGEX = ([A-Z]+)=(\S+)?
FORMAT = $1::$2
REPEAT_MATCH = true

[iptables_log_prefix]
REGEX = kernel.+?((?:\[UFW)? \S+)\s*IN=
FORMAT = log_prefix::$1

[iptables_flags]
REGEX = RES=\S+\s((?:[A-Z]{3,}\s)+)
FORMAT = FLAGS::$1

[iptables_tcp_flag]
SOURCE_KEY = FLAGS
REGEX = (\S+)
FORMAT = tcp_flag::$1
MV_ADD = true

[iptables_mac]
REGEX = MAC=(\S{17}):(\S{17}):(\S{5})
FORMAT = dest_mac::$1 src_mac::$2 FRAME_TYPE::$3

#====================================
# Lookups
#====================================
[iptables_icmp_codes_lookup]
filename = iptables_icmp_codes.csv
default_match = Unassigned
min_matches = 1

[iptables_action_lookup]
filename = iptables_action.csv
case_sensitive_match = false
match_type = WILDCARD(log_prefix), EXACT(action)
default_match = unknown
max_matches = 1
min_matches = 1

[iptables_transport_lookup]
filename = iptables_transport.csv
default_match = unknown
max_matches = 1
min_matches = 1

[iptables_frametypes_lookup]
filename = iptables_frametypes.csv
default_match = unknown
max_matches = 1
min_matches = 1
