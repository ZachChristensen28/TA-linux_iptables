# DO NOT EDIT THIS FILE!
# Please make all changes to files in $SPLUNK_HOME/etc/apps/TA_linux_iptables/local.
# To make changes, copy the section/stanza you want to change from $SPLUNK_HOME/etc/apps/TA_linux_iptables/default
# into ../local and edit there.

#====================================
# Syslog (See README)
#====================================
[syslog]
disabled = true
TRANSFORMS-iptables_sourcetyper = iptables_sourcetyper

#====================================
# linux:iptables
#====================================
[linux:iptables]
TRANSFORMS-iptables_sourcetyper    = iptables_ufw_sourcetyper
FIELDALIAS-iptables_dest           = DST AS dest
FIELDALIAS-iptables_dest_port      = DPT AS dest_port
FIELDALIAS-iptables_dest_ip        = DST AS dest_ip
FIELDALIAS-iptables_dvc            = host AS dvc
FIELDALIAS-iptables_dvc_host       = host AS dvc_host
FIELDALIAS-iptables_session_id     = ID AS session_id
FIELDALIAS-iptables_dest_interface = IN AS dest_interface
FIELDALIAS-iptabels_src            = SRC AS src
FIELDALIAS-iptabels_src_interface  = OUT AS src_interface
FIELDALIAS-iptabels_src_ip         = SRC AS src_ip
FIELDALIAS-iptables_src_port       = SPT AS src_port
FIELDALIAS-iptabels_tos            = TOS AS tos
FIELDALIAS-iptabels_ttl            = TTL AS ttl
FIELDALIAS-iptabels_icmp_type      = TYPE as icmp_type
EVAL-direction                     = if(isnotnull(IN),"inbound","outbound")
EVAL-vendor_product                = "Linux Iptables"
EVAL-protocol                      = "ip"
REPORT-iptables_log_prefix         = iptables_log_prefix
REPORT-iptables_mac                = iptables_mac
REPORT-iptables_flags              = iptables_flags
REPORT-iptables_tcp_flag           = iptables_tcp_flag
LOOKUP-iptables_action             = iptables_action_lookup log_prefix OUTPUTNEW action
LOOKUP-iptables_icmp_codes         = iptables_icmp_codes_lookup TYPE OUTPUTNEW icmp_code
LOOKUP-iptables_transport          = iptables_transport_lookup PROTO OUTPUTNEW transport
LOOKUP-iptables_frame_type         = iptables_frame_type_lookup FRAME_TYPE OUTPUTNEW frame_description

#====================================
# linux:iptables:ufw
#====================================
[linux:iptables:ufw]
FIELDALIAS-iptables_dest           = DST AS dest
FIELDALIAS-iptables_dest_port      = DPT AS dest_port
FIELDALIAS-iptables_dest_ip        = DST AS dest_ip
FIELDALIAS-iptables_dvc            = host AS dvc
FIELDALIAS-iptables_dvc_host       = host AS dvc_host
FIELDALIAS-iptables_session_id     = ID AS session_id
FIELDALIAS-iptables_dest_interface = IN AS dest_interface
FIELDALIAS-iptabels_src            = SRC AS src
FIELDALIAS-iptabels_src_interface  = OUT AS src_interface
FIELDALIAS-iptabels_src_ip         = SRC AS src_ip
FIELDALIAS-iptables_src_port       = SPT AS src_port
FIELDALIAS-iptabels_tos            = TOS AS tos
FIELDALIAS-iptabels_ttl            = TTL AS ttl
FIELDALIAS-iptabels_icmp_type      = TYPE as icmp_type
EVAL-app                           = "UFW"
EVAL-vendor_product                = "Linux Iptables"
EVAL-protocol                      = "ip"
REPORT-iptables_log_prefix         = iptables_ufw_log_prefix
REPORT-iptables_mac                = iptables_mac
REPORT-iptables_flags              = iptables_flags
REPORT-iptables_tcp_flag           = iptables_tcp_flag
LOOKUP-iptables_icmp_codes         = iptables_icmp_codes_lookup TYPE OUTPUTNEW icmp_code
LOOKUP-iptables_ufw_action         = iptables_action_lookup log_prefix OUTPUTNEW action
LOOKUP-iptables_transport          = iptables_transport_lookup PROTO OUTPUTNEW transport
LOOKUP-iptables_frame_type         = iptables_frame_type_lookup FRAME_TYPE OUTPUTNEW frame_description
